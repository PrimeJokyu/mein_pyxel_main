# 第4回：確認テスト - 基礎技術の理解度チェック
**～これまでの学習成果を確認しよう！～**

## 🎯 テストの目標
- 第1～3回で学んだ技術を組み合わせて問題を解こう
---

## 📋 テスト概要

### テスト時間
**50分間**（課題A～D の合計）

### テスト形式
**実技テスト**（実際にプログラムを書いて動作させる）

### 評価方法
- 各課題の必須要素がすべて実装されているか
- プログラムが正常に動作するか
- コードが適切に書かれているか

### 合格基準
**4課題中3課題以上で基本機能が動作すること**

---

## 📚 復習：これまでに学んだ技術

### 第1回：Pyxelの基礎とビジュアル表現
- **基本構造**: `pyxel.init()`, `update()`, `draw()`, `pyxel.run()`
- **図形描画**: `pyxel.rect()`, `pyxel.circ()`, `pyxel.tri()`, `pyxel.line()`
- **文字表示**: `pyxel.text()`
- **色の管理**: 16色パレット
- **変数の活用**: 位置、色、サイズの管理

### 第2回：座標変数と自動アニメーション
- **座標管理**: グローバル変数で位置を管理
- **自動移動**: `update()`内での座標更新
- **境界処理**: 跳ね返り、ループ、停止
- **複数オブジェクト**: 独立した動きの管理
- **時間関数**: `pyxel.frame_count`の活用

### 第3回：キー入力とインタラクティブ制御
- **キー入力**: `pyxel.btn()`, `pyxel.btnp()`の使い分け
- **移動制御**: 4方向・8方向移動
- **境界制限**: 画面内でのオブジェクト制御
- **操作感向上**: 速度調整、複数キー対応

---

## 📝 課題A：図形描画（15分）

### 課題内容
指定された位置に図形を描画し、自分の名前を表示するプログラムを作成してください。

### 必須要素
1. **背景色**: 色番号3（濃い緑）で画面をクリア
2. **四角形**: 位置(30, 40)、サイズ(40×30)、色番号8（赤）
3. **円**: 中心(100, 70)、半径15、色番号12（青）
4. **三角形**: 頂点(120, 30), (130, 50), (140, 30)、色番号10（黄色）
5. **名前表示**: 位置(10, 10)、色番号7（白）で自分の名前

### 実装のヒント
```python
import pyxel

pyxel.init(160, 120)

def update():
    pass  # この課題では何もしない

def draw():
    # ここに描画処理を書く
    pyxel.cls(3)  # 背景色
    
    # 四角形を描画
    pyxel.rect(30, 40, 40, 30, 8)
    
    # 円を描画
    pyxel.circ(100, 70, 15, 12)
    
    # 三角形を描画
    pyxel.tri(120, 30, 130, 50, 140, 30, 10)
    
    # 名前を表示
    pyxel.text(10, 10, "あなたの名前", 7)

pyxel.run(update, draw)
```

### チェックポイント
- [ ] 背景が濃い緑色になっている
- [ ] 赤い四角形が正しい位置・サイズで表示される
- [ ] 青い円が正しい位置・サイズで表示される
- [ ] 黄色い三角形が正しい頂点で表示される
- [ ] 白い文字で名前が表示される

---

## 📝 課題B：座標変数の活用（15分）

### 課題内容
変数を使って図形の位置を管理し、図形を右に移動させるプログラムを作成してください。

### 必須要素
1. **図形**: 円（色は自由）を画面に表示
2. **変数管理**: 図形の位置を変数で管理
3. **移動**: 図形が右に少しずつ移動する
4. **リセット**: 図形が画面右端に到達したら左端に戻る

### 実装のヒント
```python
import pyxel

# グローバル変数
circle_x = 20  # 円のX座標
circle_y = 60  # 円のY座標

pyxel.init(160, 120)

def update():
    global circle_x
    
    # 右に移動
    circle_x += 2
    
    # 画面右端で左端にリセット
    if circle_x > 160:
        circle_x = 0

def draw():
    pyxel.cls(1)  # 背景色
    pyxel.circ(circle_x, circle_y, 10, 8)  # 円を描画

pyxel.run(update, draw)
```

### チェックポイント
- [ ] 円が変数で位置管理されている
- [ ] 円が右方向に移動している
- [ ] 画面右端で左端に戻っている
- [ ] 移動が滑らかに見える

---

## 📝 課題C：自動移動システム（20分）

### 課題内容
ボールが画面内で跳ね返りながら移動するプログラムを作成してください。

### 必須要素
1. **ボール**: 円形のボールを画面に表示
2. **左右移動**: 左右の壁で跳ね返る
3. **上下移動**: 上下の壁で跳ね返る
4. **4面跳ね返り**: 画面の4つの壁すべてで跳ね返る

### 実装のヒント
```python
import pyxel

# ボールの初期状態
ball_x = 80
ball_y = 60
dx = 3  # X方向の移動量
dy = 2  # Y方向の移動量

pyxel.init(160, 120)

def update():
    global ball_x, ball_y, dx, dy
    
    # 位置を更新
    ball_x += dx
    ball_y += dy
    
    # 左右の壁で跳ね返り
    if ball_x <= 0 or ball_x >= 160:
        dx = -dx
    
    # 上下の壁で跳ね返り
    if ball_y <= 0 or ball_y >= 120:
        dy = -dy

def draw():
    pyxel.cls(0)  # 背景色
    pyxel.circ(ball_x, ball_y, 8, 14)  # ピンクのボール

pyxel.run(update, draw)
```

### チェックポイント
- [ ] ボールが斜めに移動している
- [ ] 左右の壁で正しく跳ね返る
- [ ] 上下の壁で正しく跳ね返る
- [ ] 永続的に動き続ける

---

## 📝 課題D：キー操作制御（15分）

### 課題内容
矢印キーで四角形を操作できるプログラムを作成してください。

### 必須要素
1. **四角形**: 操作可能な四角形を画面に表示
2. **矢印キー移動**: 矢印キーで上下左右に移動
3. **境界制限**: 画面外に出ないよう制限
4. **リセット機能**: Rキーで中央位置にリセット

### 実装のヒント
```python
import pyxel

# プレイヤーの初期状態
player_x = 80
player_y = 60

pyxel.init(160, 120)

def update():
    global player_x, player_y
    
    # 矢印キーで移動
    if pyxel.btn(pyxel.KEY_LEFT):
        player_x -= 2
    if pyxel.btn(pyxel.KEY_RIGHT):
        player_x += 2
    if pyxel.btn(pyxel.KEY_UP):
        player_y -= 2
    if pyxel.btn(pyxel.KEY_DOWN):
        player_y += 2
    
    # 境界制限
    player_x = max(5, min(player_x, 155))
    player_y = max(5, min(player_y, 115))
    
    # Rキーでリセット
    if pyxel.btnp(pyxel.KEY_R):
        player_x = 80
        player_y = 60

def draw():
    pyxel.cls(12)  # 青い背景
    pyxel.rect(player_x-5, player_y-5, 10, 10, 8)  # 赤い四角形

pyxel.run(update, draw)
```

### チェックポイント
- [ ] 矢印キーで四角形が移動する
- [ ] 画面外に出ない制限がある
- [ ] Rキーでリセットできる

---

## ⏰ テスト進行のコツ

### 時間配分の目安
1. **課題A（15分）**: 比較的簡単、確実に完成させる
2. **課題B（15分）**: 基本的な動き、丁寧に作る  
3. **課題C（20分）**: 最も時間をかけて完璧に
4. **課題D（15分）**: キー操作、テストしながら作る

### 実装順序のおすすめ
1. **基本構造を作る**: `init`, `update`, `draw`, `run`
2. **必須要素を1つずつ追加**: 段階的に機能を追加
3. **テストしながら進める**: 各要素が動作することを確認
4. **最後に調整**: 色や位置の微調整

### デバッグのポイント
- **エラーが出たら**: まず構文エラーがないかチェック
- **動かない時**: `global`宣言を忘れていないかチェック
- **変な動きをする時**: 計算式や条件分岐をチェック

---

## 🏆 評価基準詳細

### 基本点（各課題20点、合計100点）

#### 課題A：図形描画（20点）
- 背景色正しく設定（4点）
- 四角形正しく描画（4点）
- 円正しく描画（4点）
- 三角形正しく描画（4点）
- 名前表示（4点）

#### 課題B：座標変数（20点）
- 変数で位置管理（5点）
- 右移動の実装（5点）
- 画面端でのリセット（5点）
- 滑らかな動作（5点）

#### 課題C：自動移動（20点）
- 基本移動の実装（5点）
- 左右跳ね返り（5点）
- 上下跳ね返り（5点）
- 継続的な動作（5点）

#### 課題D：キー操作（20点）
- 4方向移動（8点）
- 境界制限（6点）
- リセット機能（6点）

#### 課題E：総合問題（20点）
- プレイヤー操作（6点）
- 自動ボール（6点）
- 色変更機能（4点）
- 全体動作（4点）

### 加点要素（各課題最大5点）
- **コードの美しさ**: 適切な変数名、コメント
- **独創的な工夫**: 指定以上の機能追加
- **エラーハンドリング**: 想定外の操作への対応

---

## 🚨 よくあるミスと対策

### 1. 構文エラー
```python
# ❌ よくある間違い
def update()  # コロン忘れ
    global player_x player_y  # カンマ忘れ

# ✅ 正しい書き方
def update():
    global player_x, player_y
```

### 2. global宣言忘れ
```python
# ❌ エラーになる
def update():
    player_x += 1  # global宣言がない

# ✅ 正しい書き方
def update():
    global player_x
    player_x += 1
```

### 3. 条件分岐のミス
```python
# ❌ 境界判定が不完全
if ball_x > 160:
    dx = -dx  # 画面を超えてから判定

# ✅ 正しい境界判定
if ball_x <= 0 or ball_x >= 160:
    dx = -dx  # 境界に到達時点で判定
```

### 4. btn/btnpの使い分けミス
```python
# ❌ 移動に btnp を使用
if pyxel.btnp(pyxel.KEY_LEFT):
    player_x -= 2  # 一瞬しか動かない

# ✅ 移動には btn を使用
if pyxel.btn(pyxel.KEY_LEFT):
    player_x -= 2  # 押している間動く
```

---

## 📚 参考：完全解答例

### 課題A完全解答
```python
import pyxel

pyxel.init(160, 120)

def update():
    pass

def draw():
    pyxel.cls(3)  # 濃い緑の背景
    pyxel.rect(30, 40, 40, 30, 8)  # 赤い四角形
    pyxel.circ(100, 70, 15, 12)  # 青い円
    pyxel.tri(120, 30, 130, 50, 140, 30, 10)  # 黄色い三角形
    pyxel.text(10, 10, "Taro Yamada", 7)  # 白い文字

pyxel.run(update, draw)
```

---

## 🎯 テスト後の振り返り

### セルフチェック項目
テスト後、以下の点を振り返ってみましょう：

1. **時間管理**: 各課題に適切な時間をかけられたか？
2. **理解度**: どの技術が得意で、どれが苦手だったか？
3. **デバッグ**: エラーを効率的に解決できたか？
4. **コード品質**: 読みやすく、保守しやすいコードが書けたか？

### 不合格だった場合
- **復習すべき内容を明確にする**
- **苦手な技術を重点的に練習する**  
- **次回テストに向けた学習計画を立てる**

### 合格した場合
- **得意分野をさらに伸ばす**
- **次のステップ（第2サイクル）への準備**
- **より高度な課題への挑戦**

---

## 📝 まとめ

### テストのポイント
- **基礎技術の確実な定着**: 第1～3回の内容を統合活用
- **制限時間内での実装力**: 効率的な開発スキル
- **デバッグ能力**: 問題発見・解決スキル

### 次回予告：「オリジナル作品制作」
テストに合格したら、いよいよ創造性を発揮する時間！
- **完全自由制作**: 学んだ技術で好きなものを作る
- **発表・共有**: みんなで作品を見せ合う
- **相互学習**: 他の人のアイデアから学ぶ

頑張って！君たちの実力を存分に発揮してください！ 🌟